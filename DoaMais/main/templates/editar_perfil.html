<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Editar Perfil</title>
  <link rel="stylesheet" href="../static/css/editar_perfil.css">
  <link rel="stylesheet" href="../static/css/navbar.css">
  <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css" />
</head>
<body>
    {% include 'navbar.html' %}
    <div class="profile-container">
        <header>
          <h1>Editar Perfil</h1>
        </header>
  
        <div class="profile-edit">
            <div class="avatar-edit">
                <img class="avatar" src="../static/imagens/imagem_perfil.png" alt="Editar Foto">
                <button class="edit-photo">Editar Foto</button>
            </div>
            <form class="edit-form" method="POST" action="{% url 'editar_perfil' %}" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="avatar-edit">
                    <img class="avatar" src="{{ user.photo.url }}" alt="Editar Foto">
                    <input type="file" id="photo" name="photo" class="edit-photo">
                </div>
                <label for="first_name">Nome</label>
                <input type="text" id="first_name" name="first_name" value="{{ user.first_name }}">
            
                <label for="last_name">Sobrenome</label>
                <input type="text" id="last_name" name="last_name" value="{{ user.last_name }}">
            
                <label for="username">Nome de Usuário</label>
                <input type="text" id="username" name="username" value="{{ user.username }}">
            
                <label for="email">Email</label>
                <input type="email" id="email" name="email" value="{{ user.email }}">
  
                <div class="preferences">
                    <h3>Categorias de Preferência</h3>
                    <label><input type="checkbox" name="preference" value="roupa"> Roupa</label>
                    <label><input type="checkbox" name="preference" value="movel"> Móvel</label>
                    <label><input type="checkbox" name="preference" value="eletronico"> Eletrônico</label>
                    <label><input type="checkbox" name="preference" value="livro"> Livro</label>
                    <label><input type="checkbox" name="preference" value="material_escolar"> Material Escolar</label>
                  </div>
                  
  
                <div class="buttons">
                    <button type="button" id="cancel">Cancelar</button>
                    <button type="submit" id="save">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    
    <script src="../static/js/loadNavbar.js"></script>

    <script>
        // JavaScript for handling image upload and preview
        document.querySelector('.edit-photo').addEventListener('click', function() {
            let fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'image/*';
            fileInput.onchange = e => {
                let file = e.target.files[0];
                let reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = readerEvent => {
                    let content = readerEvent.target.result;
                    document.querySelector('.avatar').src = content;
                };
            };
            fileInput.click();
        });

        // JavaScript for handling button actions
        document.addEventListener("DOMContentLoaded", function() {
            const cancelButton = document.getElementById("cancel");
            const saveButton = document.getElementById("save");

            // Redirect to 'perfil.html' when cancel button is clicked
            cancelButton.addEventListener("click", function() {
                window.location.href = "perfil.html";
            });

            // Redirect to 'perfil.html' when save button is clicked
            // Note: This should be replaced with actual form submission logic
            saveButton.addEventListener("click", function(event) {
                event.preventDefault(); // Prevent the default form submission
                window.location.href = "perfil.html";
            });
        });
      </script>
</body>
</html>